
[ ТЗ: Разработать программу для EDSAC, реализующую циклический сдвиг массива чисел ]
[ на заданное количество разрядов влево, и предполагающую загрузчик IO2. ]
[ Массив хранится в ячейках 136-142 ]
[ Количество сдвигов хранится в ячейке 135 ]
[ результат сохраняется на месте исходного массива ячейки 136-142 ]
[ ячейки 0-2 рабочие ]


         T 56 K                 [ директива IO2, установка адреса загрузки ]
         G    K                 [ директива IO2, фиксация начального адреса подпрограммы ]
[ 0:]    A 3 F                  [ пролог: формирование кода инструкции возврата в Acc ]
[ 1:]    T 61 @                 [ пролог: запись инструкции возврата ]

[ 2:]    A 0 F                  [ загрузка в аккумулятор адреса 0-го элемента массива ]
[ 3:]    A 26[r1] @             [ прибавляем код инструкции с нулевым полем адреса ]
[ 4:]    T 26[r1] @             [ запись сформированной инструкции, обнуление аккумулятора ]

[ 5:]    A 0 F                  [ загрузка в аккумулятор адреса 0-го элемента массива ]
[ 6:]    A 28[r2] @             [ прибавляем код инструкции с полем адреса 1 ]
[ 7:]    S 63[c2] @             [ уменьшаем код инструкции на 2 ]
[ 8:]    T 28[r2] @             [ запись сформированной инструкции, обнуление аккумулятора ]

[ 9:]    A 0 F                  [ загрузка в аккумулятор адреса 0-го элемента массива ]
[10:]    A 29[w1] @             [ прибавляем код инструкции с нулевым полем адреса ]
[11:]    T 29[w1] @             [ запись сформированной инструкции, обнуление аккумулятора ]

[12:]    A 0 F                  [ загрузка в аккумулятор адреса 0-го элемента массива ]
[13:]    A 31[w2] @             [ прибавляем код инструкции с полем адреса 1 ]
[14:]    S 63[c2] @             [ уменьшаем код инструкции на 2 ]
[15:]    T 31[w2] @             [ запись сформированной инструкции, обнуление аккумулятора ]
[16:]    A 1 F                  [ загрузка в аккумулятор длины массива ]
[17:]    T 66 @                 [ запись этого значения в ячейку 122 ]

         [loop1:]
[18:]    A 2 F                  [ загружаем счетчик необработанных элементов массива ]
[19:]    S 62[c1] @             [ уменьшаем на 1 ]
[20:]    G 60[<exit>] @         [ если результат меньше 0, завершаем работу ]
[21:]    T 2 F                  [ обновляем значение счетчика и обнуляем аккумулятор ]

         [loop2:]
[22:]        A 66 @             [ загружаем счетчик необработанных элементов массива ]
[23:]        S 62[<c1>] @       [ уменьшаем на 1 ]
[24:]        G 41 [<exit>] @    [ если результат меньше 0, завершаем работу ]
[25:]        T 66 @             [ обновляем значение счетчика и обнуляем аккумулятор ]
[26:] [r1:]  A 0 F              [ загрузка в аккумулятор значения из ячейки N ]
[27:]        T 0 F              [ запись этого значения в рабочую ячейку, обнуление аккумулятора ]
[28:] [r2:]  A 1 F              [ загрузка в аккумулятор значения из ячейки N+1 ]
[29:] [w1:]  T 0 F              [ запись этого значения в ячейку с адресом N, обнуление аккумулятора ]
[30:]        A 0 F              [ загрузка в аккумулятор значения из ячейки 0 ]
[31:] [w2:]  T 1 F              [ запись этого значения в ячейку с адресом N+1, обнуление аккумулятора ]
[32:]        A 28[<r2>] @       [ загрузка в аккумулятор кодa инструкции r2 ]
[33:]        U 26[<r1>] @       [ запись инструкции  поле r1 ]
[34:]        S 63[<c2>] @       [ уменьшение кода инструкции ]
[35:]        T 28[<r2>] @       [ запись сформированной инструкции, обнуление аккумулятора ]
[36:]        A 31[<w2>] @       [ загрузка в аккумулятор кодa инструкции w2 ]
[37:]        U 29[<w1>] @       [ запись инструкции  поле w1 ]
[38:]        S 63[<c2>] @       [ уменьшение кода инструкции ]
[39:]        T 31[<w2>] @       [ запись сформированной инструкции, обнуление аккумулятора ]
[40:]        E 22[<loop2:>] @   [ повторяем все операции; аккумулятор обнулен ]
[41:]        A 65 @             [ загрузка в аккумулятор длины массива ]
[42:]        T 66 @             [ запись этого значения в ячейку 122 ]

[43:]        A 64[c6] @        [ загрузка в аккумулятор константы 6 ]
[44:]        L 0 D
[45:]        A 26[r1] @         [ прибавляем код инструкции ]
[46:]        T 26[r1] @         [ запись сформированной инструкции, обнуление аккумулятора ]

[47:]        A 64[c6] @        [ загрузка в аккумулятор константы 6 ]
[48:]        L O D
[49:]        A 28[r2] @         [ прибавляем код инструкции ]
[50:]        T 28[r2] @         [ запись сформированной инструкции, обнуление аккумулятора ]

[51:]        A 64[c6] @        [ загрузка в аккумулятор константы 6 ]
[52:]        L O D
[53:]        A 29[w1] @         [ прибавляем код инструкции ]
[54:]        T 29[w1] @         [ запись сформированной инструкции, обнуление аккумулятора ]

[55:]        A 64[c6] @        [ загрузка в аккумулятор константы 6 ]
[56:]        L O D
[57:]        A 31[w2] @         [ прибавляем код инструкции ]
[58:]        T 31[w2] @         [ запись сформированной инструкции, обнуление аккумулятора ]
[59:]        E 18[loop1:] @     [ повторяем все операции; аккумулятор обнулен ]
      [exit:]
[60:]        T 0 F              [ обнуление аккумулятора ]
      [ret:]
[61:]        E 0 F              [ эпилог: инструкция возврата из подпрограммы ]

[62:] [c1:]  P 0 D      [ константа 1 ]
[63:] [c2:]  P 1 F      [ константа 2 ]
[64:] [c6:]  P 3 F      [ константа 6 ]
      [LEN]
[65:]        P 3 D      [ константа 7 ]
[66:]        P 1 F

       G K             [ директива IO2, фиксация начального адреса программы ]
[ 0:] Z 0 F
[ 1:] A 10 [<addr>] @  [ адрес конца массива ]
[ 2:] T 0 F            [ запись адреса массива в ячейку 0, обнуление аккумулятора ]
[ 3:] A 11 [<len>] @   [ длина массива ]
[ 4:] T 1 F            [ запись длины массива в ячейку 1, обнуление аккумулятора ]
[ 5:] A 12[COUNT] @    [ счетчик ]
[ 6:] T 2 F            [ запись счетчика в ячейку 2, обнуление аккумулятора ]
[ 7:] A 7 @            [\ вызов        ]
[ 8:] G 56 [<sub>] F   [/ подпрограммы ]
[ 9:] Z 0 F            [ останов ]
[ADDR0:]
[10:] P 19 [<array>] @ [ адрес конца массива ]
[LEN:]
[11:] P 3 D            [ длина массива - 7 (0…0|0|0…101|1 = 7) ]
[COUNT:]
[12:] P 2 F  [4]
[array:]
[13:] P 0 D [ 1 ]
[14:] P 1 F [ 2 ]
[15:] P 1 D [ 3 ]
[16:] P 2 F [ 4 ]
[17:] P 2 D [ 5 ]
[18:] P 3 F [ 6 ]
[19:] P 3 D [ 7 ]
      EZ PF [директива IO2,переход в исполнению ]
